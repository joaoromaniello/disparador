<!DOCTYPE html>
<html>
<head>
  <title>Escaneie o QR Code</title>
  <link rel="stylesheet" href="/connect.css">
  <script>
    async function verificarStatus() {
      const response = await fetch('/instance/status?token=<%= token %>');
      const data = await response.json();
      if (data.connected) {
        window.location.href = '/disparo?token=<%= token %>';
      }
    }
    setInterval(verificarStatus, 3000);
  </script>
</head>
<body>
  <div class="header-bar">
    Conectar WhatsApp (QR Code)
  </div>
  <div class="qr-card">
    <div class="qr-instruction">
      <h1>Escaneie o QR Code</h1>
      <p>Abra o WhatsApp, toque nos 3 pontinhos &gt; Aparelhos conectados &gt; Conectar novo aparelho.<br>
      Escaneie o QR code abaixo para conectar esta inst√¢ncia.
      </p>
    </div>

    <% if (qrcode) { %>
      <img src="<%= qrcode %>" alt="QR Code do WhatsApp" />
      <div class="status-bar">Aguardando leitura...</div>
    <% } else { %>
      <div class="error-message">
        Erro ao obter QR Code. Atualize ou tente conectar novamente.
      </div>
    <% } %>
  </div>
</body>
</html>
